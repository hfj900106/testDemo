<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.hzed.easyget.persistence.ext.mapper.UserExtMapper">

    <select id="queryUnRepayment" resultType="com.hzed.easyget.persistence.ext.entity.UserExt">
        SELECT bid.id AS id,bill.repayment_time AS repaymentTime from t_loan_bill bill
        LEFT JOIN t_loan_bid bid ON bill.bid_id = bid.id
        WHERE bid.status = 5 AND bill.status = 1
        AND bid.user_id = #{id}
    </select>

    <select id="listUserTransaction" resultType="com.hzed.easyget.persistence.ext.entity.UserTransactionExt" >
        SELECT ut.bid_id bidId,ut.amount,ut.status,ut.update_time updateTime,ut.account,ut.type FROM t_loan_user_transaction ut WHERE ut.user_id=#{userId, jdbcType=BIGINT} AND STATUS=2
        UNION
        SELECT o.bid_id bidId,o.amount_real+o.amount_reduction amount,2 STATUS,o.create_time updateTime,NULL account,2 TYPE FROM t_loan_offline_repayment o JOIN t_loan_bid b ON o.bid_id=b.id WHERE b.user_id=#{userId, jdbcType=BIGINT}
    </select>

</mapper>

